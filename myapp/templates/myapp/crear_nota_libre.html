{% extends 'myapp/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <h2>Crear Nota Libre</h2>
  <form method="post">
    {% csrf_token %}

    <div class="form-group">
      <label for="titulo">Título</label>
      <input type="text" name="titulo" id="titulo" class="form-control" required>
    </div>

    <div class="form-group">
      <label for="categoria">Categoría</label>
      <select name="categoria" id="categoria" class="form-control">
        <option value="">-- Sin categoría --</option>
        {% for cat in categorias %}
          <option value="{{ cat.id }}">{{ cat.nombre }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="form-group">
      <label>Contenido</label>
      <div id="editor" style="height: 300px;"></div>
      <input type="hidden" name="contenido_html" id="contenido_html">
    </div>

    <button type="submit" class="btn btn-success">Guardar nota</button>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<!-- Quill.js CDN -->
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

<script>
  const quill = new Quill('#editor', {
    theme: 'snow',
    placeholder: 'Escribe tu nota libre aquí...',
    modules: {
      toolbar: [
        [{ header: [1, 2, 3, false] }],
        ['bold', 'italic', 'underline', 'strike'],
        [{ list: 'ordered' }, { list: 'bullet' }],
        ['link', 'image'],
        ['clean']
      ]
    }
  });

  document.querySelector('form').onsubmit = function() {
    document.querySelector('#contenido_html').value = quill.root.innerHTML;
  };
</script>
{% endblock %}
